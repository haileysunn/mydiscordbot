const { SlashCommandBuilder } = require('@discordjs/builders');
const { EmbedBuilder } = require('discord.js');
const fs = require('fs');

module.exports = {
  data: new SlashCommandBuilder()
    .setName("ì‹œë„ˆì§€")
    .setDescription("ì‹œë„ˆì§€ ê´€ë ¨ ì •ë³´ë¥¼ ì œê³µí•©ë‹ˆë‹¤.")
    .addSubcommand(subcommand =>
      subcommand.setName('í‘œ').setDescription('ì‹œë„ˆì§€ í‘œ'))
    .addSubcommand(subcommand =>
      subcommand.setName('ì¢…ë¥˜').setDescription('ì„ íƒí•œ ì‹œë„ˆì§€ë¥¼ ê°€ì§„ ì§ì—…ì„ ê²€ìƒ‰í•©ë‹ˆë‹¤.')
        .addIntegerOption(option => option.setName('ì„ íƒ')
          .setDescription('ì‹œë„ˆì§€ë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”.')
          .setRequired(true)
          .addChoices(
            { name: 'ì¹˜ì ', value: 0 },
            { name: 'ê³µì¦/ê³µë²„í”„', value: 1 },
            { name: 'ë°›í”¼ì¦', value: 2 },
            { name: 'ë°©ê¹', value: 3 },
            { name: 'ë°±í—¤ë“œ', value: 4 },
            { name: 'ë¬´ë ¥', value: 5 },
            { name: 'ê³µì´ì†', value: 6 },
            { name: 'í”¼ì¦/ë‚™ì¸', value: 7 },
            { name: 'ë©´ì—­', value: 8 },
            { name: 'ë§ˆë‚˜íšŒë³µì¦ê°€', value: 9 },
            { name: 'ì •í™”', value: 10 },
          )))
    .addSubcommand(subcommand =>
      subcommand.setName('ì§ì—…').setDescription('í•´ë‹¹ ì§ì—…ì´ ê°€ì§„ ì‹œë„ˆì§€ë¥¼ ì•Œë ¤ë“œë¦½ë‹ˆë‹¤.')
        .addIntegerOption(option => option.setName('ì„ íƒ')
          .setDescription('ì§ì—…ì„ ì„ íƒí•´ì£¼ì„¸ìš”.')
          .setRequired(true)
          .addChoices(
            { name: 'ê±´ìŠ¬ë§ì–´', value: 11 },
            { name: 'ê¸°ê³µì‚¬', value: 12 },
            { name: 'ê¸°ìƒìˆ ì‚¬', value: 13 },
            { name: 'ë°ëª¨ë‹‰', value: 14 },
            { name: 'ë°ë¹Œí—Œí„°', value: 15 },
            { name: 'ë„í™”ê°€', value: 16 },
            { name: 'ë””ìŠ¤íŠ¸ë¡œì´ì–´', value: 17 },
            { name: 'ë¦¬í¼', value: 18 },
            { name: 'ë°”ë“œ', value: 19 },
            { name: 'ë°°í‹€ë§ˆìŠ¤í„°', value: 20 },
            { name: 'ë²„ì„œì»¤', value: 21 },
            { name: 'ë¸”ë˜ìŠ¤í„°', value: 22 },
            { name: 'ë¸”ë ˆì´ë“œ', value: 23 },
            { name: 'ì„œë¨¸ë„ˆ', value: 24 },
            { name: 'ì†Œì„œë¦¬ìŠ¤', value: 25 },
            { name: 'ìŠ¤ì¹´ìš°í„°', value: 26 },
            { name: 'ìŠ¤íŠ¸ë¼ì´ì»¤', value: 27 },
            { name: 'ì•„ë¥´ì¹´ë‚˜', value: 28 },
            { name: 'ì›Œë¡œë“œ', value: 29 },
            { name: 'ì¸íŒŒì´í„°', value: 30 },
            { name: 'ì°½ìˆ ì‚¬', value: 31 },
            { name: 'í˜¸í¬ì•„ì´', value: 32 },
            { name: 'í™€ë¦¬ë‚˜ì´íŠ¸', value: 33 },
          ))),
  async execute(interaction) {
    const userid = interaction.user.id;
    try {
      const selection = interaction.options.getInteger("ì„ íƒ")
      let exampleEmbed = new EmbedBuilder()
        .setColor('#A6FF4D')
        .setTitle('[ ì‹œë„ˆì§€ ì •ë³´ ]')
      if (selection == null) {
        exampleEmbed.setImage("https://media.discordapp.net/attachments/948917805653315614/990570456287428669/unknown.png");
      } else if (selection < 11) {
        exampleEmbed.setFooter({ text: 'â­ ìƒì‹œ ì‹œë„ˆì§€ / âš¡ ê°ì„±ê¸° / ğŸ§¼ ì•„ì´ë´í‹°í‹° ìŠ¤í‚¬' })
        exampleEmbed.addFields({ name: `${synInfo[selection][0]}`, value: synInfo[selection][1] })
      } else {
        exampleEmbed.setFooter({ text: 'âš¡ ê°ì„±ê¸° / ğŸ§¼ ì•„ì´ë´í‹°í‹° ìŠ¤í‚¬' })
        exampleEmbed.addFields({ name: `${jobInfo[selection-11][0]} ë³´ìœ  ì‹œë„ˆì§€ ìŠ¤í‚¬`, value: jobInfo[selection-11][1] })
      }

      await interaction.reply({ embeds: [exampleEmbed] })
    } catch (err) {
      errorHandling(userid, '32_synergy 01 execute', err)
    }
  }
}

const synInfo = [
  ['ì¹˜ëª…íƒ€ ì ì¤‘ë¥ /ì¹˜ì ', `18% [ë°°í‹€ë§ˆìŠ¤í„°, ì°½ìˆ ì‚¬, ìŠ¤íŠ¸ë¼ì´ì»¤]\n12% [ë„í™”ê°€âš¡]\n10% [ê±´ìŠ¬ë§ì–´â­, ë°ë¹Œí—Œí„°â­, ì•„ë¥´ì¹´ë‚˜â­, ê¸°ìƒìˆ ì‚¬â­, ì›Œë¡œë“œâš¡]`],
  ['ê³µê²©ë ¥ ì¦ê°€/ê³µì¦', `6% [ìŠ¤ì¹´ìš°í„°, ê¸°ê³µì‚¬, ë°”ë“œ, í™€ë¦¬ë‚˜ì´íŠ¸, ë„í™”ê°€]\nì„œí¿ì€ 15%ë¡œ ì ìš©ë¨`],
  ['ë°›ëŠ” í”¼í•´ ì¦ê°€/ë°›í”¼ì¦', `6% [ë²„ì„œì»¤â­, í˜¸í¬ì•„ì´â­, ì¸íŒŒì´í„°â­, ì†Œì„œë¦¬ìŠ¤â­, ë°ëª¨ë‹‰â­]`],
  ['ë°©ì–´ë ¥ ê°ì†Œ/ë°©ê¹', `12% [ë¸”ë˜ìŠ¤í„°â­, ë””ìŠ¤íŠ¸ë¡œì´ì–´â­, ì›Œë¡œë“œâ­, ì„œë¨¸ë„ˆâ­, ë¦¬í¼â­]`],
  ['ë°±í—¤ë“œ ì–´íƒ í”¼í•´ ì¦ê°€/ë°±í—¤ë“œ', `12% [ì›Œë¡œë“œ, ë¸”ë ˆì´ë“œâ­]`],
  ['ë¬´ë ¥ ì‹œë„ˆì§€/ë¬´ë ¥', `20% [ë¸”ë˜ìŠ¤í„°, ì¸íŒŒì´í„°, ë””ìŠ¤íŠ¸ë¡œì´ì–´]`],
  ['ê³µì´ì† ì¦ê°€/ê³µì´ì†', `ê³µì´ì† [ë°°í‹€ë§ˆìŠ¤í„°(ê³µ5.5% ì´11%), ë¸”ë ˆì´ë“œ(ê³µ25% ì´19.8%), ë„í™”ê°€(ê³µ8% ì´30%)]\nê³µì† [í™€ë¦¬ë‚˜ì´íŠ¸(19.8%), ìŠ¤íŠ¸ë¼ì´ì»¤(8%), ë°”ë“œ(3.5%+ê°•ì¸í•œì—°ì£¼8%) ì›Œë¡œë“œ(25%)]\nì´ì† [ê¸°ìƒìˆ ì‚¬ğŸ§¼(12~12.5%), í˜¸í¬ì•„ì´ğŸ§¼(4%, ë‘ë™8%)]`],
  ['ì£¼ëŠ” í”¼í•´ ì¦ê°€/í”¼ì¦/ë‚™ì¸', `10% [í™€ë¦¬ë‚˜ì´íŠ¸, ë„í™”ê°€, ë°”ë“œ]\n5~15% [ë°”ë“œğŸ§¼]`],
  ['ë””ë²„í”„ ë©´ì—­/ë©´ì—­', `ìƒíƒœì´ìƒë©´ì—­ [ë°”ë“œ]\ní”¼ê²©ë©´ì—­ [ë„í™”ê°€]`],
  ['ë§ˆë‚˜ íšŒë³µ ì¦ê°€', `40% [ì„œë¨¸ë„ˆ] 12% [ë°”ë“œ]\n50% [í™€ë¦¬ë‚˜ì´íŠ¸] 21% [ë„í™”ê°€]`],
  ['ì •í™”', `[ê¸°ê³µì‚¬, ì„œë¨¸ë„ˆ, í™€ë¦¬ë‚˜ì´íŠ¸, ì›Œë¡œë“œ, ë„í™”ê°€]`],];
const jobInfo = [
  ['ê±´ìŠ¬ë§ì–´', '[ì¹˜ì  10%] ë‚˜ì„ ì˜ì¶”ì ì, ë¯¼ì²©í•œ ì‚¬ê²©, ì´í€¼ë¦¬ë¸Œë¦¬ì—„'],
  ['ê¸°ê³µì‚¬', '[ê³µì¦ 6%] ë‚´ê³µ ë°©ì¶œ, íšŒì„ ê²©ì¶”, íŒŒì‡„ì¥\n[ì •í™”] ë‚´ê³µ ë°©ì¶œ'],
  ['ê¸°ìƒìˆ ì‚¬', '[ì¹˜ì  10%] í¼ì¹˜ê¸°, ë‚´ë ¤ì°ê¸°, ëŒê°œë°”ëŒ\n[ì´ì† 12%] (ì§ˆí’ë…¸ë„)ì—¬ìš°ë¹„ğŸ§¼\n[ì´ì† 12.5%] ì„¼ë°”ëŒ'],
  ['ë°ëª¨ë‹‰', '[ë°›í”¼ì¦ 6%] í•˜ìš¸ë§, ë°ëª¨ë‹‰ ìŠ¬ë˜ì‰¬, ë£¨ì¸ ëŸ¬ì‰¬, ë°ìŠ¤ í´ë¡œ'],
  ['ë°ë¹Œí—Œí„°', '[ì¹˜ì  10%] ë‚˜ì„ ì˜ì¶”ì ì, AT02 ë¥˜íƒ„, ì´í€¼ë¦¬ë¸Œë¦¬ì—„'],
  ['ë„í™”ê°€', '[ì¹˜ì  12%] ì§„ê²½ì‚°ìˆ˜âš¡\n[ê³µë²„í”„ 6%] í•´ìš°ë¬¼\n[ê³µì´ì† 8%, 30%] ë‚œì¹˜ê¸°\n[í”¼ì¦/ë‚™ì¸ 10%] ë‚œì¹˜ê¸°, í˜¸ì ‘ëª½, ë¨¹ë¬¼ì„¸ë¡€, ì €ë¬´ëŠ” ë‹¬ğŸ§¼\n[í”¼ê²©ë©´ì—­] í™˜ì˜ì˜ ë¬¸\n[ë§ˆë‚˜íšŒë³µì¦ê°€ 21%] í•´ìš°ë¬¼\n[ì •í™”] í™˜ì˜ì˜ ë¬¸'],
  ['ë””ìŠ¤íŠ¸ë¡œì´ì–´', '[ë°©ê¹ 12%] íŒŒì›Œ ìŠ¤íŠ¸ë¼ì´í¬, ë“œë ˆë“œë…¸íŠ¸, ì í•‘ ìŠ¤ë§¤ì‰¬\n[ë¬´ë ¥ 20%] ëŸ¬ë‹ í¬ë˜ì‰¬'],
  ['ë¦¬í¼', '[ë°©ê¹ 12%] ì‰ë„ìš° ë‹·, ë‚˜ì´íŠ¸ ë©”ì–´'],
  ['ë°”ë“œ', '[ê³µë²„í”„ 6%] ì²œìƒì˜ ì—°ì£¼\n[ê³µì† 3.5%] ì²œìƒì˜ ì—°ì£¼(2íŠ¸í¬ ê°•ì¸í•œì—°ì£¼ +8%)\n[í”¼ì¦/ë‚™ì¸ 10%] ìŠ¤í‹°ê·¸ë§ˆ, ë¹›ì˜ ê´‘ì‹œê³¡, ìŒí‘œ ë­‰ì¹˜, ì²œìƒì˜ ì—°ì£¼, ì‚¬ìš´ë“œ ì‡¼í¬, ìŒíŒŒ ì§„ë™, ìœ¨ë™ì˜ í•˜í”„\n[í”¼ì¦/ë‚™ì¸ 5~15%] ìš©ë§¹ì˜ ì—°ì£¼ğŸ§¼\n[ìƒíƒœì´ìƒë©´ì—­] ìˆ˜í˜¸ì˜ ì—°ì£¼\n[ë§ˆë‚˜íšŒë³µì¦ê°€ 12%] ì²œìƒì˜ ì—°ì£¼'],
  ['ë°°í‹€ë§ˆìŠ¤í„° ', '[ì¹˜ì  18%] ìš©ë§¹ì˜ í¬íš¨\n[ê³µì´ì† 5.5%, 11%] ë°”ëŒì˜ ì†ì‚­ì„'],
  ['ë²„ì„œì»¤', '[ë°›í”¼ì¦ 6%] ë ˆë“œ ë”ìŠ¤íŠ¸, ë§ˆìš´í‹´ í¬ë˜ì‰¬'],
  ['ë¸”ë˜ìŠ¤í„°', '[ë°©ê¹ 12%] í¬íƒ‘ì†Œí™˜, ê°•í™”íƒ„, í¬ê²©: ê³¡ì‚¬í¬\n[ë¬´ë ¥ 20%] ë„¤ì´íŒœíƒ„'],
  ['ë¸”ë ˆì´ë“œ', '[ë°±í—¤ë“œ 12%] ìŠ¤í•€ ì»¤í„°\n[ê³µì´ì† 25%, 19.8%] ë§ˆì—˜ìŠ¤í†°'],
  ['ì„œë¨¸ë„ˆ', '[ë°©ê¹ 12%] ìˆœê°„ í­ë°œ, ëˆì ì´ëŠ” ì´ë¼ëŠª, ìŠˆë¥´ë””\n[ë§ˆë‚˜íšŒë³µì¦ê°€ 40%] ìŠˆë¥´ë””\n[ì •í™”] ë ˆì´ë„¤ì˜ ê°€í˜¸'],
  ['ì†Œì„œë¦¬ìŠ¤', '[ë°›í”¼ì¦ 6%] ë¸”ë ˆì´ì¦ˆ, ì—ë„ˆì§€ ë°©ì¶œ, ë¼ì´íŠ¸ë‹ ë³¼í…ìŠ¤'],
  ['ìŠ¤ì¹´ìš°í„°', '[ê³µì¦ 6%] í„ìŠ¤ íŒŒì´ì–´, ë³¼ë¦¿ í•´ì¼, [ìƒì‹œ] (ë³€ì‹ ìƒíƒœ)'],
  ['ìŠ¤íŠ¸ë¼ì´ì»¤', '[ê³µì† 8%] ë²ˆê°œì˜ ì†ì‚­ì„\n[ì¹˜ì  18%] ë²ˆê°œì˜ ì†ì‚­ì„'],
  ['ì•„ë¥´ì¹´ë‚˜', '[ì¹˜ì  10%] ìŠ¤í¬ë˜ì¹˜ ë”œëŸ¬, ë¦¬í„´'],
  ['ì›Œë¡œë“œ', '[ì¹˜ì  10%] ì‹¬íŒì˜ì°½âš¡\n[ë°©ê¹ 12%] ë°©íŒ¨ ê²©ë™, ë°°ì‰¬, ë°©íŒ¨ ë°€ì¹˜ê¸°\n[ë°±í—¤ë“œ 12%] ì¦ì˜¤ì˜ í•¨ì„±\n[25%] ë„¬ë¼ì‹œì•„ì˜ ê¸°ìš´\n[ì •í™”] ë„¬ë¼ì‹œì•„ì˜ ê¸°ìš´'],
  ['ì¸íŒŒì´í„°', '[ë°›í”¼ì¦ 6%] íŒŒì‡„ì˜ ê°•íƒ€, ë§¹í˜¸ê²©\n[ë¬´ë ¥ 20%] íšŒì‹¬ì˜ ì¼ê²©'],
  ['ì°½ìˆ ì‚¬', '[ì¹˜ì  18%] ì²­ë£¡ì§„'],
  ['í˜¸í¬ì•„ì´', '[ë°›í”¼ì¦ 6%] ë˜í”¼ë“œ ìƒ·, ì•„í† ë¯¹ ì• ë¡œìš°\n[ì´ì† 4%](ë‘ë™8%]) MK2 ë§¤ ì†Œí™˜ğŸ§¼'],
  ['í™€ë¦¬ë‚˜ì´íŠ¸', '[ê³µë²„í”„ 6%] ì‹ ì˜ ë¶„ë…¸\n[ê³µì† 19.8%] ì²œìƒì˜ ì¶•ë³µ\n[í”¼ì¦/ë‚™ì¸ 10%] ì‹ ì˜ ìœ¨ë²•, ë¹›ì˜ ì¶©ê²©, ì •ì˜ì˜ ê²€, ì‹ ì„±í•œ í­ë°œ, ì‹ ì„±í•œ ì˜¤ë¼ğŸ§¼\n[ë§ˆë‚˜íšŒë³µì¦ê°€ 50%] ì²œìƒì˜ ì¶•ë³µ\n[ì •í™”] ì‹ ì„±í•œ ë³´í˜¸'],
];

function errorHandling(userid, exp, error) {
  const today = new Date(+new Date() + 3240 * 10000)
  const date = today.toISOString().split("T")[0];
  const ts = today.toISOString().replace("T", " ").replace(/\..*/, '');

  const filePath = `./log/log_${date}.csv`;
  !fs.existsSync(filePath) ? fs.writeFileSync(filePath, 'timestamp,userid,exp,error') : null;
  fs.appendFileSync(filePath, `\r\n${ts},${userid},${exp},${error.stack.replace(/\n|\r/g, '\t')}`);
}